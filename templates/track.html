{% extends "base.html" %}
{% block content %}

<div class="container my-5">

    <div class="card shadow-lg border-0 p-4">

        <h2 class="text-center mb-4">Track Your Order</h2>

        <!-- Search Form -->
        <form method="POST" class="row g-3 justify-content-center mb-4">
            <div class="col-md-6">
                <input type="number" name="order_id" class="form-control form-control-lg"
                       placeholder="Enter your Order ID" required>
            </div>
            <div class="col-md-3">
                <button class="btn btn-primary btn-lg w-100">
                    Track Order
                </button>
            </div>
        </form>

        {% if order %}
        <hr>

        <h4 class="text-center">Order #{{ order.id }}</h4>

        <!-- Status Progress -->
        {% set steps = ["Confirmed", "Shipped", "Out for Delivery", "Delivered"] %}
        <div class="my-4">
            <div class="d-flex justify-content-between align-items-center">
                {% for step in steps %}
                <div class="text-center">
                    <div class="badge p-2 
                        {% if steps.index(step) <= steps.index(order.status) %}
                            bg-success
                        {% else %}
                            bg-secondary
                        {% endif %}
                    ">
                        {{ step }}
                    </div>
                </div>
                {% if not loop.last %}
                <div class="flex-fill border-top mx-2"></div>
                {% endif %}
                {% endfor %}
            </div>
        </div>

        <!-- Delivery Info -->
        <div class="row mt-4">
            <div class="col-md-6">
                <h4>Shipping Address</h4>
                <p>
                    {{ order.address }}<br>
                    {{ order.city }}, {{ order.zip_code }}, {{ order.country }}
                </p>
            </div>

            <div class="col-md-6">
                <h4>Delivery Info</h4>
                <p>
                    <strong>Courier:</strong> {{ order.delivery_company }}<br>
                    <strong>Estimated Delivery:</strong> {{ order.delivery_date }}
                </p>
            </div>
        </div>

        <!-- Items -->
        <h5 class="mt-4">Items</h5>
        <ul class="list-group">
            {% for item in order.items %}
            <li class="list-group-item d-flex justify-content-between">
                <span>{{ item.product_name }}</span>
                <span>x{{ item.quantity }}</span>
            </li>
            {% endfor %}
        </ul>

        {% elif order is not none %}
        <p class="text-center text-danger">Order not found.</p>
        {% endif %}

    </div>
</div>

{% endblock %}
